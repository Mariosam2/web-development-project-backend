// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

// Looking for ways to speed up your queries, or scale easily with your serverless or edge functions?
// Try Prisma Accelerate: https://pris.ly/cli/accelerate-init

generator client {
  provider = "prisma-client"
  output   = "../generated/prisma"
}

datasource db {
  provider = "mysql"
}

model User {
  id           String    @id @default(uuid())
  googleId     String?   @unique
  firstname    String?
  lastname     String?
  username     String    @unique
  email        String    @unique
  password     String?
  tokenVersion Int       @default(1)
  imageId      String?   @unique
  image        Image?    @relation(fields: [imageId], references: [id])
  workouts     Workout[]
}

model Exercise {
  id               String            @id @default(uuid())
  exerciseId       String            @unique @db.Char(36)
  name             String
  description      String?           @db.LongText
  bodyPart         String?
  targetMuscle     String?
  imageUrl         String?
  videoUrl         String?
  exerciseWorkouts ExerciseWorkout[]
}

model Workout {
  id                String            @id @default(uuid())
  title             String
  exerciseWorkouts  ExerciseWorkout[]
  estimatedDuration Int?
  imageId           String?           @unique
  image             Image?            @relation(fields: [imageId], references: [id])
  userId            String
  user              User              @relation(fields: [userId], references: [id])
}

model ExerciseWorkout {
  workoutId     String   @db.Char(36)
  workout       Workout  @relation(fields: [workoutId], references: [id])
  exerciseId    String   @db.Char(36)
  exercise      Exercise @relation(fields: [exerciseId], references: [id])
  exerciseOrder Int
  reps          Int
  sets          Int

  @@id([workoutId, exerciseId])
}

model Image {
  id       String   @id @default(uuid())
  filename String
  user     User?
  workout  Workout?
}
